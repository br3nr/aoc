# note:
# Why are cephalopods like this?
#
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⣤⣾⠿⠿⠿⠿⠶⠶⢤⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⢀⠌⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⠈⠙⠳⣄⠀⠀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⡰⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⠍⡀⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠠⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⡟⡀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⡅⠀⠀⠀⠀⣴⣶⡆⠀⠀⠀⠀⣶⣶⡄⠀⠀⠀⠀⠓⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠇⠀⠀⠀⠀⠙⠛⠁⠰⢦⠴⠀⠙⠛⠁⠀⠀⠀⠀⡄⠀⠀⠀⠀⠀
# ⠀⠀⠀⠀⠀⠸⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⢠⠁⠀⠀⠀⠀⠀
# ⠀⠀⠀⡠⢔⢜⠱⣤⠈⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠤⠄⠓⠃⠐⠠⢀⠀⠀⠀
# ⢀⠔⠁⠈⢀⠎⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢆⠀⠀⠑⢄⠀
# ⡇⠤⠒⡨⠁⠀⠀⠀⠀⢁⣴⠄⠀⠀⠀⠀⠀⠈⢖⠄⠀⠀⠀⠀⠀⢃⠢⢄⡀⡅
# ⠘⠒⠒⣇⠀⠀⠀⠀⡠⣺⣿⠀⠀⠀⠀⠀⠀⠀⣸⣎⠄⡀⠀⠀⠀⠀⡗⣒⡺⠂
# ⠀⠀⠀⠀⠛⠂⠙⠓⠛⠉⢏⣢⡄⠀⠀⠀⢀⣰⠛⠛⠳⠮⠥⠶⣒⠎⠁⠀⠀⠀
# ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠉⠉⠉⠉⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀


f = open("input.txt")
f = f.read().split("\n")

cols = list(zip(*f))
mode = ""
c = l = 0
for col in cols:
    op, p = col[-1], col[:-1]
    if op == "*":
        mode = "mul"
        l = 1
    elif op == "+":
        mode = "sum"
        l = 0

    if set(col) != {" "}:
        n = int("".join(p).replace(" ", ""))
        if mode == "mul":
            l *= n
        else:
            l += n
    else:
        c += l

print(c + l)
